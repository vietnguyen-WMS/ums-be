<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CORS Test</title>
  </head>
  <body>
    <h1>CORS Test for UMS API</h1>
    <button onclick="testLogin()">Test Login API</button>
    <button onclick="testMe()">Test /auth/me API</button>
    <button onclick="testLogout()">Test Logout API</button>
    <button onclick="testHealth()">Test Health API</button>
    <div id="result"></div>

    <script>
      async function testLogin() {
        const resultDiv = document.getElementById("result");
        resultDiv.innerHTML = "Testing login API...";

                 try {
           const response = await fetch("http://localhost:8080/auth/login", {
             method: "POST",
             credentials: "include", // Important: include cookies
             headers: {
               "Content-Type": "application/json",
             },
             body: JSON.stringify({
               username: "admin",
               password: "password123",
             }),
           });

          const data = await response.json();
          resultDiv.innerHTML =
            "<h3>Login Test Result:</h3><pre>" +
            JSON.stringify(data, null, 2) +
            "</pre>";
        } catch (error) {
          resultDiv.innerHTML =
            "<h3>Error:</h3><pre>" + error.message + "</pre>";
        }
      }

      async function testHealth() {
        const resultDiv = document.getElementById("result");
        resultDiv.innerHTML = "Testing health API...";

                 try {
           const response = await fetch("http://localhost:8080/auth/health", {
             method: "GET",
             credentials: "include", // Important: include cookies
             headers: {
               "Content-Type": "application/json",
             },
           });

          const data = await response.text();
          resultDiv.innerHTML =
            "<h3>Health Test Result:</h3><pre>" + data + "</pre>";
        } catch (error) {
          resultDiv.innerHTML =
            "<h3>Error:</h3><pre>" + error.message + "</pre>";
                 }
       }

       async function testMe() {
         const resultDiv = document.getElementById("result");
         resultDiv.innerHTML = "Testing /auth/me API...";

         try {
           const response = await fetch("http://localhost:8080/auth/me", {
             method: "GET",
             credentials: "include", // Important: include cookies
             headers: {
               "Content-Type": "application/json",
             },
           });

           if (response.ok) {
             const data = await response.json();
             resultDiv.innerHTML =
               "<h3>/auth/me Test Result:</h3><pre>" +
               JSON.stringify(data, null, 2) +
               "</pre>";
           } else {
             resultDiv.innerHTML =
               "<h3>/auth/me Test Result:</h3><pre>Status: " +
               response.status +
               " - " +
               response.statusText +
               "</pre>";
           }
         } catch (error) {
           resultDiv.innerHTML =
             "<h3>Error:</h3><pre>" + error.message + "</pre>";
         }
       }

       async function testLogout() {
         const resultDiv = document.getElementById("result");
         resultDiv.innerHTML = "Testing logout API...";

         try {
           const response = await fetch("http://localhost:8080/auth/logout", {
             method: "POST",
             credentials: "include", // Important: include cookies
             headers: {
               "Content-Type": "application/json",
             },
           });

           if (response.ok) {
             const data = await response.json();
             resultDiv.innerHTML =
               "<h3>Logout Test Result:</h3><pre>" +
               JSON.stringify(data, null, 2) +
               "</pre>";
           } else {
             resultDiv.innerHTML =
               "<h3>Logout Test Result:</h3><pre>Status: " +
               response.status +
               " - " +
               response.statusText +
               "</pre>";
           }
         } catch (error) {
           resultDiv.innerHTML =
             "<h3>Error:</h3><pre>" + error.message + "</pre>";
         }
       }
     </script>
   </body>
 </html>
